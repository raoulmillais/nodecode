<!DOCTYPE html>

<html>

<head>
    <!--[if IE]>
    <script type="text/javascript>
        window.location = 'http://upgradeyourbrowser.org/';
    </script>
    <![endif]-->
    <title>Animated Ball</title>
    <link href="css/main.css" rel="stylesheet" type="text/css" />

    <script type="text/javascript" src="js/lib/jquery-1.4.2.min.js"></script>
    
    <script type="text/javascript" src="js/src/Utils.js"></script>
    <script type="text/javascript" src="js/src/Color.js"></script>
    <script type="text/javascript" src="js/src/Circle.js"></script>
    <script type="text/javascript" src="js/src/Stage.js"></script>
    <script type="text/javascript" src="js/src/Easing.js"></script>
    <script type="text/javascript" src="js/src/Animation.js"></script>
</head>

<body>
    <header class="site">
        <hgroup>
            <h1>Test</h1>
        </hgroup>
    </header>
    <canvas id="tile-canvas" width="400" height="400">
        <div>
            Your browser does not support canvas
        </div>
    </canvas>

    <div class="control">
        <form>
            <div id="control-stroke-colour-section">
                <span id="control-stroke-colour-label">Select Colour:</span>
                <ul id="control-stroke-colour">
                    <li id="control-stroke-colour-cyan">&nbsp;</li>
                    <li id="control-stroke-colour-orange">&nbsp;</li>
                    <li id="control-stroke-colour-purple">&nbsp;</li>
                    <li id="control-stroke-colour-lime" class="selected">&nbsp;</li>
                </ul>
            </div>
            <p>
                <label for="control-node-count">Nodes (Currently <span id="current-node-count">35</span>):</label>
                <input type="text" name="control-node-count" id="control-node-count" value="5" />
                <input type="button" id="add-nodes" value="Add" class="update" />
                <input type="button" id="remove-nodes" value="Remove" class="update" />
            </p>
        </form>
    </div>

    <script type="text/javascript">
        (function() {
            var nodeRedValue = 25,
                nodeGreenValue = 240,
                nodeBlueValue = 252,
                stage;
            
               
            document.addEventListener('DOMContentLoaded', function() {
                stage = Object.create(Stage);
                stage.init('tile-canvas', 20, 400);
                
                var color = Object.create(Color);
                color.init(nodeRedValue, nodeGreenValue, 252, 0.5);
                
                var ball = Object.create(Circle);
                ball.init(0, 200, 50, color);
                
                var ballAnimation = Object.create(Animation);
                ballAnimation.init(stage, 2000, 0, 300, ball, 'x', false, Easing.easeOutSine); 
                
                stage.actors.push(ball);
                stage.animations.push(ballAnimation);
                stage.start();
            }, false);
            
            
            $(document).ready(function() {
                var $canvas = $('#tile-canvas');
                console.log($canvas.offset().left + ',' + $canvas.offset().top);
                $canvas.click(function(evt) {
                    console.log('canvas clicked pageX,Y: ' + evt.pageX + ',' + evt.pageY);
                    console.log('canvas clicked clientX,Y: ' + evt.clientX + ',' + evt.clientY);
                    var newColor = Object.create(Color);
                    newColor.init(25, 240, 252, 0.5);
                    
                    var newX = evt.pageX - $canvas.offset().left,
                        newY = evt.pageY - $canvas.offset().top;
                    
                    var newBall = Object.create(Circle);
                    newBall.init(newX, newY, 50, newColor);
                    
                    var newBallAnimation = Object.create(Animation);
                    newBallAnimation.init(stage, 2000, newX, newX + 300, newBall, 'x', false, Easing.easeOutSine); 

                    stage.actors.push(newBall);
                    stage.animations.push(newBallAnimation);
                    newBallAnimation.start();
                
                });
                
                
                $('#control-node-colour li').click(function() {
                    $('#control-node-colour li').removeClass('selected');
                    $(this).toggleClass('selected');
                    
                    switch (this.id) {
                        case 'control-node-colour-cyan':
                            nodeRedValue = 25;
                            nodeGreenValue = 240;
                            nodeBlueValue = 252;
                            break;
                        case 'control-node-colour-lime':
                            nodeRedValue = 201;
                            nodeGreenValue = 255;
                            nodeBlueValue = 32;
                            break;
                        case 'control-node-colour-orange':
                            nodeRedValue = 252;
                            nodeGreenValue = 90;
                            nodeBlueValue = 0;
                            break;
                        case 'control-node-colour-purple':
                            nodeRedValue = 243;
                            nodeGreenValue = 0;
                            nodeBlueValue = 252;
                            break;
                    }
                });
            });
        })();
    </script>
    
</body>

</html>
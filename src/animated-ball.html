<!DOCTYPE html>

<html>

<head>
    <!--[if IE]>
    <script type="text/javascript>
        window.location = 'http://upgradeyourbrowser.org/';
    </script>
    <![endif]-->
    <title>Animated Ball</title>
    <link href="css/main.css" rel="stylesheet" type="text/css" />

    <script type="text/javascript" src="js/lib/jquery-1.4.2.min.js"></script>
    
    <script type="text/javascript" src="js/src/Utils.js"></script>
    <script type="text/javascript" src="js/src/Color.js"></script>
    <script type="text/javascript" src="js/src/Circle.js"></script>
    <script type="text/javascript" src="js/src/Stage.js"></script>
    <script type="text/javascript" src="js/src/Easing.js"></script>
    <script type="text/javascript" src="js/src/Animation.js"></script>
</head>

<body>
    <header class="site">
        <hgroup>
            <h1>Test</h1>
        </hgroup>
    </header>
    <canvas id="tile-canvas" width="400" height="400">
        <div>
            Your browser does not support canvas
        </div>
    </canvas>

    <div class="control">
        <form>
            <div id="control-stroke-colour-section">
                <span id="control-stroke-colour-label">Select Colour:</span>
                <ul id="control-stroke-colour">
                    <li id="control-stroke-colour-cyan">&nbsp;</li>
                    <li id="control-stroke-colour-orange">&nbsp;</li>
                    <li id="control-stroke-colour-purple">&nbsp;</li>
                    <li id="control-stroke-colour-lime" class="selected">&nbsp;</li>
                </ul>
            </div>
            <p>
                <label for="control-node-count">Stage:</label>
                <input type="button" id="stage-start" value="Start" class="update" />
                <input type="button" id="stage-stop" value="Stop" class="update" />
                <input type="button" id="stage-rewind" value="Rewind" class="update" />
            </p>
        </form>
    </div>

    <script type="text/javascript">
        (function() {
               
            $(document).ready(function() {
                var $canvas = $('#tile-canvas'),
                    nodeRedValue = 25,
                    nodeGreenValue = 240,
                    nodeBlueValue = 252,
                    stage = Object.create(Stage);
                    color = Object.create(Color),
                    ball = Object.create(Circle),
                    ballAnimation = Object.create(Animation);
                    
                stage.init('tile-canvas', 20, 400);
                // export the stage for debugging
                window.stage = stage;
                
                color.init(nodeRedValue, nodeGreenValue, 252, 0.5);
                ball.init(0, 200, 50, color);
                ballAnimation.init(stage, 2000, 0, 300, ball, 'x', false, Easing.easeOutSine); 
                
                stage.actors.push(ball);
                stage.animations.push(ballAnimation);
                //stage.start();

                $canvas.click(function(evt) {
                    var newColor = Object.create(Color),
                        newBall = Object.create(Circle),
                        newBallAnimation = Object.create(Animation),
                        newX = evt.pageX - $canvas.offset().left,
                        newY = evt.pageY - $canvas.offset().top;
                    
                    newColor.init(nodeRedValue, nodeGreenValue, nodeBlueValue, 0.5);
                    newBall.init(newX, newY, 50, newColor);
                    
                    newBallAnimation.init(stage, 2000, newX, newX + 300, newBall, 'x', false, Easing.easeOutSine); 

                    stage.actors.push(newBall);
                    stage.animations.push(newBallAnimation);
                    newBallAnimation.start();
                
                });
                
                
                $('#control-stroke-colour li').click(function() {
                    $('#control-stroke-colour li').removeClass('selected');
                    $(this).toggleClass('selected');
                    
                    switch (this.id) {
                        case 'control-stroke-colour-cyan':
                            nodeRedValue = 25;
                            nodeGreenValue = 240;
                            nodeBlueValue = 252;
                            break;
                        case 'control-stroke-colour-lime':
                            nodeRedValue = 201;
                            nodeGreenValue = 255;
                            nodeBlueValue = 32;
                            break;
                        case 'control-stroke-colour-orange':
                            nodeRedValue = 252;
                            nodeGreenValue = 90;
                            nodeBlueValue = 0;
                            break;
                        case 'control-stroke-colour-purple':
                            nodeRedValue = 243;
                            nodeGreenValue = 0;
                            nodeBlueValue = 252;
                            break;
                    }
                });
                
                $('#stage-start').click(function() { stage.start(); });
                $('#stage-stop').click(function() { stage.stop(); });
                $('#stage-rewind').click(function() { stage.rewind(); });
            });
        })();
    </script>
    
</body>

</html>